"use strict";if("undefined"==typeof window)var bitauth=require("../index");else var bitauth=window.bitauth;var chai=chai||require("chai");describe("bitauth",function(){var e=chai.should(),i={priv:"97811b691dd7ebaeb67977d158e1da2c4d3eaa4ee4e2555150628acade6b344c",pub:"02326209e52f6f17e987ec27c56a1321acf3d68088b8fb634f232f12ccbc9a4575",sin:"Tf3yr5tYvccKNVrE26BrPs6LWZRh8woHwjR"},t="c6b7f6bfe5bb19b1e390e55ed4ba5df8af6068d0eb89379a33f9c19aacf6c08c",u=null,a="Tf1Jc1xSbqasm5QLwwSQc5umddx2h7mAMhX",n="TfG4ScDgysrSpodWD4Re5UtXmcLbY5CiUHA",r="keyboard cat",s="o hai, nsa. how i do teh cryptos?",c="s4705hiru13z!",o="291Dm9unZMwfxBA7BEHiQsraRxCrMRqwJ2TjCWwEH3Sp5QGMehNFNgZLo62sgF5Khe",d=null,l=null;describe("#generateSin",function(){it("should generate a sin object",function(i){u=bitauth.generateSin(),e.exist(u),e.exist(u.pub),e.exist(u.priv),e.exist(u.sin),i()})}),describe("#getPublicKeyFromPrivateKey",function(){it("should properly get the public key",function(e){bitauth.getPublicKeyFromPrivateKey(u.priv).should.equal(u.pub),e()}),it("should properly get compressed public key from a previously known private key",function(e){bitauth.getPublicKeyFromPrivateKey(i.priv).should.equal(i.pub),e()})}),describe("#getSinFromPublicKey",function(){it("should properly get the sin",function(e){bitauth.getSinFromPublicKey(u.pub).should.equal(u.sin),e()}),it("should properly get the sin from a previously known compressed public key",function(e){bitauth.getSinFromPublicKey(i.pub).should.equal(i.sin),e()})}),describe("#sign",function(){it("should sign the string",function(i){d=bitauth.sign(r,u.priv),e.exist(d),i()})}),describe("#verifySignature",function(){it("should verify the signature",function(i){bitauth.verifySignature(r,u.pub,d,function(t,u){e.not.exist(t),e.exist(u),u.should.equal(!0),i()})}),it("should verify the signature with leading zero public key",function(i){var u={priv:t,pub:bitauth.getPublicKeyFromPrivateKey(t)};d=bitauth.sign(r,u.priv),bitauth.verifySignature(r,u.pub,d,function(i,t){e.not.exist(i),e.exist(t),t.should.equal(!0)}),i()})}),describe("#validateSinTrue",function(){it("should validate the sin as true",function(i){var t=bitauth.validateSin(n);e.equal(!0,t),i()})}),describe("#validateSinFalse",function(){it("should validate the sin as false because of bad checksum",function(i){var t=bitauth.validateSin(a);e.equal(!1,t),i()}),it("should validate the sin as false because of non-base58",function(i){var t=bitauth.validateSin("not#base!58");e.equal(!1,t),i()})}),describe("#validateSinCallback",function(){it("should receive error callback",function(i){bitauth.validateSin(a,function(t){e.exist(t),t.message.should.equal("Checksum does not match"),i()})})}),"undefined"==typeof window&&(describe("#encrypt",function(){it("should encrypt the secret message",function(i){l=bitauth.encrypt(c,s),e.exist(l),i()})}),describe("#decrypt",function(){it("should decrypt the secret message",function(i){var t=bitauth.decrypt(c,l);e.exist(t),t.should.equal(s),i()}),it("should decrypt a previously known message",function(i){var t=bitauth.decrypt(c,o);e.exist(t),t.should.equal(s),i()})}),describe("#middleware",function(){it("should expose an express middleware",function(e){bitauth.middleware({},{},function(){e()})})}))});